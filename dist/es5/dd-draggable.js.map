{"version":3,"file":"dd-draggable.js","sourceRoot":"","sources":["../../src/dd-draggable.ts"],"names":[],"mappings":"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","sourcesContent":["/**\r\n * dd-draggable.ts 7.3.0\r\n * Copyright (c) 2021-2022 Alain Dumesny - see GridStack root license\r\n */\r\n\r\nimport { DDManager } from './dd-manager';\r\nimport { Utils } from './utils';\r\nimport { DDBaseImplement, HTMLElementExtendOpt } from './dd-base-impl';\r\nimport { GridItemHTMLElement, DDUIData } from './types';\r\nimport { DDElementHost } from './dd-element';\r\nimport { isTouch, touchend, touchmove, touchstart, pointerdown } from './dd-touch';\r\n\r\n// TODO: merge with DDDragOpt ?\r\nexport interface DDDraggableOpt {\r\n  appendTo?: string | HTMLElement;\r\n  handle?: string;\r\n  helper?: string | HTMLElement | ((event: Event) => HTMLElement);\r\n  // containment?: string | HTMLElement; // TODO: not implemented yet\r\n  // revert?: string | boolean | unknown; // TODO: not implemented yet\r\n  // scroll?: boolean; // native support by HTML5 drag drop, can't be switch to off actually\r\n  start?: (event: Event, ui: DDUIData) => void;\r\n  stop?: (event: Event) => void;\r\n  drag?: (event: Event, ui: DDUIData) => void;\r\n}\r\n\r\ninterface DragOffset {\r\n  left: number;\r\n  top: number;\r\n  width: number;\r\n  height: number;\r\n  offsetLeft: number;\r\n  offsetTop: number;\r\n}\r\n\r\ntype DDDragEvent = 'drag' | 'dragstart' | 'dragstop';\r\n\r\n// let count = 0; // TEST\r\n\r\nexport class DDDraggable extends DDBaseImplement implements HTMLElementExtendOpt<DDDraggableOpt> {\r\n  public el: HTMLElement;\r\n  public option: DDDraggableOpt;\r\n  public helper: HTMLElement; // used by GridStackDDNative\r\n\r\n  /** @internal */\r\n  protected mouseDownEvent: MouseEvent;\r\n  /** @internal */\r\n  protected dragOffset: DragOffset;\r\n  /** @internal */\r\n  protected dragElementOriginStyle: Array<string>;\r\n  /** @internal */\r\n  protected dragEl: HTMLElement;\r\n  /** @internal true while we are dragging an item around */\r\n  protected dragging: boolean;\r\n  /** @internal */\r\n  protected parentOriginStylePosition: string;\r\n  /** @internal */\r\n  protected helperContainment: HTMLElement;\r\n  /** @internal properties we change during dragging, and restore back */\r\n  protected static originStyleProp = ['transition', 'pointerEvents', 'position', 'left', 'top', 'minWidth', 'willChange'];\r\n  /** @internal pause before we call the actual drag hit collision code */\r\n  protected dragTimeout: number;\r\n\r\n  constructor(el: HTMLElement, option: DDDraggableOpt = {}) {\r\n    super();\r\n    this.el = el;\r\n    this.option = option;\r\n    // get the element that is actually supposed to be dragged by\r\n    let handleName = option.handle.substring(1);\r\n    this.dragEl = el.classList.contains(handleName) ? el : el.querySelector(option.handle) || el;\r\n    // create var event binding so we can easily remove and still look like TS methods (unlike anonymous functions)\r\n    this._mouseDown = this._mouseDown.bind(this);\r\n    this._mouseMove = this._mouseMove.bind(this);\r\n    this._mouseUp = this._mouseUp.bind(this);\r\n    this.enable();\r\n  }\r\n\r\n  public on(event: DDDragEvent, callback: (event: DragEvent) => void): void {\r\n    super.on(event, callback);\r\n  }\r\n\r\n  public off(event: DDDragEvent): void {\r\n    super.off(event);\r\n  }\r\n\r\n  public enable(): void {\r\n    if (this.disabled === false) return;\r\n    super.enable();\r\n    this.dragEl.addEventListener('mousedown', this._mouseDown);\r\n    if (isTouch) {\r\n      this.dragEl.addEventListener('touchstart', touchstart);\r\n      this.dragEl.addEventListener('pointerdown', pointerdown);\r\n      // this.dragEl.style.touchAction = 'none'; // not needed unlike pointerdown doc comment\r\n    }\r\n    this.el.classList.remove('ui-draggable-disabled');\r\n    this.el.classList.add('ui-draggable');\r\n  }\r\n\r\n  public disable(forDestroy = false): void {\r\n    if (this.disabled === true) return;\r\n    super.disable();\r\n    this.dragEl.removeEventListener('mousedown', this._mouseDown);\r\n    if (isTouch) {\r\n      this.dragEl.removeEventListener('touchstart', touchstart);\r\n      this.dragEl.removeEventListener('pointerdown', pointerdown);\r\n    }\r\n    this.el.classList.remove('ui-draggable');\r\n    if (!forDestroy) this.el.classList.add('ui-draggable-disabled');\r\n  }\r\n\r\n  public destroy(): void {\r\n    if (this.dragTimeout) window.clearTimeout(this.dragTimeout);\r\n    delete this.dragTimeout;\r\n    if (this.dragging) this._mouseUp(this.mouseDownEvent);\r\n    this.disable(true);\r\n    delete this.el;\r\n    delete this.helper;\r\n    delete this.option;\r\n    super.destroy();\r\n  }\r\n\r\n  public updateOption(opts: DDDraggableOpt): DDDraggable {\r\n    Object.keys(opts).forEach(key => this.option[key] = opts[key]);\r\n    return this;\r\n  }\r\n\r\n  /** @internal call when mouse goes down before a dragstart happens */\r\n  protected _mouseDown(e: MouseEvent): boolean {\r\n    // don't let more than one widget handle mouseStart\r\n    if (DDManager.mouseHandled) return;\r\n    if (e.button !== 0) return true; // only left click\r\n\r\n    // make sure we are not clicking on known object that handles mouseDown (TODO: make this extensible ?) #2054\r\n    const skipMouseDown = ['input', 'textarea', 'button', 'select', 'option'];\r\n    const name = (e.target as HTMLElement).nodeName.toLowerCase();\r\n    if (skipMouseDown.find(skip => skip === name)) return true;\r\n    // also check for content editable\r\n    if ((e.target as HTMLElement).closest('[contenteditable=\"true\"]')) return true;\r\n\r\n    // REMOVE: why would we get the event if it wasn't for us or child ?\r\n    // make sure we are clicking on a drag handle or child of it...\r\n    // Note: we don't need to check that's handle is an immediate child, as mouseHandled will prevent parents from also handling it (lowest wins)\r\n    // let className = this.option.handle.substring(1);\r\n    // let el = e.target as HTMLElement;\r\n    // while (el && !el.classList.contains(className)) { el = el.parentElement; }\r\n    // if (!el) return;\r\n\r\n    this.mouseDownEvent = e;\r\n    delete this.dragging;\r\n    delete DDManager.dragElement;\r\n    delete DDManager.dropElement;\r\n    // document handler so we can continue receiving moves as the item is 'fixed' position, and capture=true so WE get a first crack\r\n    document.addEventListener('mousemove', this._mouseMove, true); // true=capture, not bubble\r\n    document.addEventListener('mouseup', this._mouseUp, true);\r\n    if (isTouch) {\r\n      this.dragEl.addEventListener('touchmove', touchmove);\r\n      this.dragEl.addEventListener('touchend', touchend);\r\n    }\r\n\r\n    e.preventDefault();\r\n    // preventDefault() prevents blur event which occurs just after mousedown event.\r\n    // if an editable content has focus, then blur must be call\r\n    if (document.activeElement) (document.activeElement as HTMLElement).blur();\r\n\r\n    DDManager.mouseHandled = true;\r\n    return true;\r\n  }\r\n\r\n  /** @internal method to call actual drag event */\r\n  protected _callDrag(e: DragEvent): void {\r\n    if (!this.dragging) return;\r\n    const ev = Utils.initEvent<DragEvent>(e, { target: this.el, type: 'drag' });\r\n    if (this.option.drag) {\r\n      this.option.drag(ev, this.ui());\r\n    }\r\n    this.triggerEvent('drag', ev);\r\n  }\r\n\r\n  /** @internal called when the main page (after successful mousedown) receives a move event to drag the item around the screen */\r\n  protected _mouseMove(e: DragEvent): boolean {\r\n    // console.log(`${count++} move ${e.x},${e.y}`)\r\n    let s = this.mouseDownEvent;\r\n\r\n    if (this.dragging) {\r\n      this._dragFollow(e);\r\n      // delay actual grid handling drag until we pause for a while if set\r\n      if (DDManager.pauseDrag) {\r\n        const pause = Number.isInteger(DDManager.pauseDrag) ? DDManager.pauseDrag as number : 100;\r\n        if (this.dragTimeout) window.clearTimeout(this.dragTimeout);\r\n        this.dragTimeout = window.setTimeout(() => this._callDrag(e), pause);\r\n      } else {\r\n        this._callDrag(e);\r\n      }\r\n    } else if (Math.abs(e.x - s.x) + Math.abs(e.y - s.y) > 3) {\r\n      /**\r\n       * don't start unless we've moved at least 3 pixels\r\n       */\r\n      this.dragging = true;\r\n      DDManager.dragElement = this;\r\n      // if we're dragging an actual grid item, set the current drop as the grid (to detect enter/leave)\r\n      let grid = (this.el as GridItemHTMLElement).gridstackNode?.grid;\r\n      if (grid) {\r\n        DDManager.dropElement = (grid.el as DDElementHost).ddElement.ddDroppable;\r\n      } else {\r\n        delete DDManager.dropElement;\r\n      }\r\n      this.helper = this._createHelper(e);\r\n      this._setupHelperContainmentStyle();\r\n      this.dragOffset = this._getDragOffset(e, this.el, this.helperContainment);\r\n      const ev = Utils.initEvent<DragEvent>(e, { target: this.el, type: 'dragstart' });\r\n\r\n      this._setupHelperStyle(e);\r\n      if (this.option.start) {\r\n        this.option.start(ev, this.ui());\r\n      }\r\n      this.triggerEvent('dragstart', ev);\r\n    }\r\n    e.preventDefault(); // needed otherwise we get text sweep text selection as we drag around\r\n    return true;\r\n  }\r\n\r\n  /** @internal call when the mouse gets released to drop the item at current location */\r\n  protected _mouseUp(e: MouseEvent): void {\r\n    document.removeEventListener('mousemove', this._mouseMove, true);\r\n    document.removeEventListener('mouseup', this._mouseUp, true);\r\n    if (isTouch) {\r\n      this.dragEl.removeEventListener('touchmove', touchmove, true);\r\n      this.dragEl.removeEventListener('touchend', touchend, true);\r\n    }\r\n    if (this.dragging) {\r\n      delete this.dragging;\r\n\r\n      // reset the drop target if dragging over ourself (already parented, just moving during stop callback below)\r\n      if (DDManager.dropElement?.el === this.el.parentElement) {\r\n        delete DDManager.dropElement;\r\n      }\r\n\r\n      this.helperContainment.style.position = this.parentOriginStylePosition || null;\r\n      if (this.helper === this.el) {\r\n        this._removeHelperStyle();\r\n      } else {\r\n        this.helper.remove();\r\n      }\r\n      const ev = Utils.initEvent<DragEvent>(e, { target: this.el, type: 'dragstop' });\r\n      if (this.option.stop) {\r\n        this.option.stop(ev); // NOTE: destroy() will be called when removing item, so expect NULL ptr after!\r\n      }\r\n      this.triggerEvent('dragstop', ev);\r\n\r\n      // call the droppable method to receive the item\r\n      if (DDManager.dropElement) {\r\n        DDManager.dropElement.drop(e);\r\n      }\r\n    }\r\n    delete this.helper;\r\n    delete this.mouseDownEvent;\r\n    delete DDManager.dragElement;\r\n    delete DDManager.dropElement;\r\n    delete DDManager.mouseHandled;\r\n    e.preventDefault();\r\n  }\r\n\r\n  /** @internal create a clone copy (or user defined method) of the original drag item if set */\r\n  protected _createHelper(event: DragEvent): HTMLElement {\r\n    let helper = this.el;\r\n    if (typeof this.option.helper === 'function') {\r\n      helper = this.option.helper(event);\r\n    } else if (this.option.helper === 'clone') {\r\n      helper = Utils.cloneNode(this.el);\r\n    }\r\n    if (!document.body.contains(helper)) {\r\n      Utils.appendTo(helper, this.option.appendTo === 'parent' ? this.el.parentNode : this.option.appendTo);\r\n    }\r\n    if (helper === this.el) {\r\n      this.dragElementOriginStyle = DDDraggable.originStyleProp.map(prop => this.el.style[prop]);\r\n    }\r\n    return helper;\r\n  }\r\n\r\n  /** @internal set the fix position of the dragged item */\r\n  protected _setupHelperStyle(e: DragEvent): DDDraggable {\r\n    this.helper.classList.add('ui-draggable-dragging');\r\n    // TODO: set all at once with style.cssText += ... ? https://stackoverflow.com/questions/3968593\r\n    const style = this.helper.style;\r\n    style.pointerEvents = 'none'; // needed for over items to get enter/leave\r\n    // style.cursor = 'move'; //  TODO: can't set with pointerEvents=none ! (done in CSS as well)\r\n    style['min-width'] = 0; // since we no longer relative to our parent and we don't resize anyway (normally 100/#column %)\r\n    style.width = this.dragOffset.width + 'px';\r\n    style.height = this.dragOffset.height + 'px';\r\n    style.willChange = 'left, top';\r\n    style.position = 'fixed'; // let us drag between grids by not clipping as parent .grid-stack is position: 'relative'\r\n    this._dragFollow(e); // now position it\r\n    style.transition = 'none'; // show up instantly\r\n    setTimeout(() => {\r\n      if (this.helper) {\r\n        style.transition = null; // recover animation\r\n      }\r\n    }, 0);\r\n    return this;\r\n  }\r\n\r\n  /** @internal restore back the original style before dragging */\r\n  protected _removeHelperStyle(): DDDraggable {\r\n    this.helper.classList.remove('ui-draggable-dragging');\r\n    let node = (this.helper as GridItemHTMLElement)?.gridstackNode;\r\n    // don't bother restoring styles if we're gonna remove anyway...\r\n    if (!node?._isAboutToRemove && this.dragElementOriginStyle) {\r\n      let helper = this.helper;\r\n      // don't animate, otherwise we animate offseted when switching back to 'absolute' from 'fixed'.\r\n      // TODO: this also removes resizing animation which doesn't have this issue, but others.\r\n      // Ideally both would animate ('move' would immediately restore 'absolute' and adjust coordinate to match,\r\n      // then trigger a delay (repaint) to restore to final dest with animate) but then we need to make sure 'resizestop'\r\n      // is called AFTER 'transitionend' event is received (see https://github.com/gridstack/gridstack.js/issues/2033)\r\n      let transition = this.dragElementOriginStyle['transition'] || null;\r\n      helper.style.transition = this.dragElementOriginStyle['transition'] = 'none'; // can't be NULL #1973\r\n      DDDraggable.originStyleProp.forEach(prop => helper.style[prop] = this.dragElementOriginStyle[prop] || null);\r\n      setTimeout(() => helper.style.transition = transition, 50); // recover animation from saved vars after a pause (0 isn't enough #1973)\r\n    }\r\n    delete this.dragElementOriginStyle;\r\n    return this;\r\n  }\r\n\r\n  /** @internal updates the top/left position to follow the mouse */\r\n  protected _dragFollow(e: DragEvent): void {\r\n    let containmentRect = { left: 0, top: 0 };\r\n    // if (this.helper.style.position === 'absolute') { // we use 'fixed'\r\n    //   const { left, top } = this.helperContainment.getBoundingClientRect();\r\n    //   containmentRect = { left, top };\r\n    // }\r\n    const style = this.helper.style;\r\n    const offset = this.dragOffset;\r\n    style.left = e.clientX + offset.offsetLeft - containmentRect.left + 'px';\r\n    style.top = e.clientY + offset.offsetTop - containmentRect.top + 'px';\r\n  }\r\n\r\n  /** @internal */\r\n  protected _setupHelperContainmentStyle(): DDDraggable {\r\n    this.helperContainment = this.helper.parentElement;\r\n    if (this.helper.style.position !== 'fixed') {\r\n      this.parentOriginStylePosition = this.helperContainment.style.position;\r\n      if (window.getComputedStyle(this.helperContainment).position.match(/static/)) {\r\n        this.helperContainment.style.position = 'relative';\r\n      }\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /** @internal */\r\n  protected _getDragOffset(event: DragEvent, el: HTMLElement, parent: HTMLElement): DragOffset {\r\n\r\n    // in case ancestor has transform/perspective css properties that change the viewpoint\r\n    let xformOffsetX = 0;\r\n    let xformOffsetY = 0;\r\n    if (parent) {\r\n      const testEl = document.createElement('div');\r\n      Utils.addElStyles(testEl, {\r\n        opacity: '0',\r\n        position: 'fixed',\r\n        top: 0 + 'px',\r\n        left: 0 + 'px',\r\n        width: '1px',\r\n        height: '1px',\r\n        zIndex: '-999999',\r\n      });\r\n      parent.appendChild(testEl);\r\n      const testElPosition = testEl.getBoundingClientRect();\r\n      parent.removeChild(testEl);\r\n      xformOffsetX = testElPosition.left;\r\n      xformOffsetY = testElPosition.top;\r\n      // TODO: scale ?\r\n    }\r\n\r\n    const targetOffset = el.getBoundingClientRect();\r\n    return {\r\n      left: targetOffset.left,\r\n      top: targetOffset.top,\r\n      offsetLeft: - event.clientX + targetOffset.left - xformOffsetX,\r\n      offsetTop: - event.clientY + targetOffset.top - xformOffsetY,\r\n      width: targetOffset.width,\r\n      height: targetOffset.height\r\n    };\r\n  }\r\n\r\n  /** @internal TODO: set to public as called by DDDroppable! */\r\n  public ui(): DDUIData {\r\n    const containmentEl = this.el.parentElement;\r\n    const containmentRect = containmentEl.getBoundingClientRect();\r\n    const offset = this.helper.getBoundingClientRect();\r\n    return {\r\n      position: { //Current CSS position of the helper as { top, left } object\r\n        top: offset.top - containmentRect.top,\r\n        left: offset.left - containmentRect.left\r\n      }\r\n      /* not used by GridStack for now...\r\n      helper: [this.helper], //The object arr representing the helper that's being dragged.\r\n      offset: { top: offset.top, left: offset.left } // Current offset position of the helper as { top, left } object.\r\n      */\r\n    };\r\n  }\r\n}\r\n"]}